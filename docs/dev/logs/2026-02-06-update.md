
🕒 對話追溯：從「專案架構診斷」到「自動化部署」
1. 初始階段：架構雜亂問題（昨日 21:39）
您提出的第一個問題核心在於：「這個由不同 LLM 迭代出來的架構，對 AI 來說是否太雜亂？」 您坦誠雖然功能漸全，但自己已看不懂目前的程式架構，且擔心 AI 讀取效率。

2. 大規模重構（昨晚 21:40 - 今日 06:30）
針對您的擔心，我們在昨晚與今日凌晨進行了一次 「專案大清掃」（見 Git 提交 4210394）：

目錄結構化：將原本散落在根目錄的腳本移入 /scripts，手冊移入 /docs，設定檔移入 /config。
建立架構地圖：撰寫了 ARCHITECTURE.md，這份文件是目前專案最重要的「導讀指南」，確保任何新加入的 LLM 都能在幾秒內理解照片從「相機 -> 本地伺服器 -> R2 -> 活動頁面」的完整流向。
清理冗餘：清理了 Mac 系統產生的隱藏檔案（._ 等），並優化了 manifest.json 的更新邏輯。
3. 解決 Hero Banner 更新失效（今日 07:00 - 09:30）
您發現 Hero Banner 修改後線上不會同步，除非手動推送到 GitHub。

診斷：我們發現 sync_to_r2.py 的路徑設定錯誤（還在找舊的 photos_web 路徑），且同步頻率太低。
修復：修正了同步路徑，並加入了 30 秒一次的靜態資源自動同步 心跳。現在起，設定檔的變更已無需 Commit & Push。
4. Hero Banner 管理介面優化（今日 09:30 - 現在）
這是我們剛剛完成的操作：

比例預覽：解決了預覽圖太窄的問題，加入 Desktop/Mobile 預覽切換。
歷史庫：實作了從伺服器讀取 assets/ 歷史檔案的功能，雖然目前讀取與刪除按鈕仍有小 Bug 待修復。
導航與保護：加入了 5MB 檔案大小限制，並試著優化 URL 模式與上傳模式的切換邏輯。



# 2026-02-06 更新日誌 (Update Log)

## 📌 更新摘要
今日主要針對 **活動背景圖片 (Hero Banner)** 的部署同步效率與管理介面進行了深度優化，旨在解決「修改需手動推送」的痛點，並提供更直覺的預覽切換體驗。

## 🚀 已實作功能
1. **自動化同步邏輯優化**
   - 修正 `sync_to_r2.py` 靜態資源同步路徑。
   - 實作每 30 秒自動偵測並上傳 `event_settings.json` 與 `assets/` 資料夾，解除對 Git Commit & Push 的依賴。

2. **背景圖管理後台介面 (Admin UI)**
   - **雙預覽模式**：支援「電腦版 (21:9)」與「手機版 (9:16)」即時切換預覽。
   - **歷史圖片庫**：提供 API 列表讀取伺服器上的歷史上傳背景圖，支援一鍵點擊切換。
   - **模式切換**：新增「恢復 URL 模式」按鈕與「手動套用 URL」介面。
   - **檔案限制**：實作伺服器端 5MB 上傳大小限制並加入標註。

3. **後端 API 端點新增/更新**
   - `GET /api/list-hero-images`：獲取歷史圖片列表。
   - `POST /api/set-hero-image`：切換指定的圖片檔案或 URL。
   - `POST /api/delete-hero-image`：清除當前選擇或物理刪除檔案。

## ⚠️ 待修復與已知問題 (Known Issues)
*   **介面反應力**：部分按鈕（刪除、套用網址）在特定瀏覽器環境下點擊無反應。
*   **圖片庫讀取**：部分舊有上傳檔案未能成功顯示在歷史庫中。
*   **同步安全性**：切換模式時可能導致 JSON 欄位短暫失效，進而影響線上頁面圖片顯示。
*   **UI 微調**：檔案上傳限制的文字太小、辨識度低；用戶建議改為彈出視窗提醒。

## 📅 下一步規劃
- 修正按鈕點擊無反應之 JS 邏輯問題。
- 優化歷史圖片庫讀取路徑。
- 實作「預覽圖疊加文字效果」功能（應對用戶未來需求）。
- 調整上傳錯誤提示為更明顯的彈出視窗。


